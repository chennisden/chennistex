\ProvidesPackage{lucky}


%%%%%%%
%ESSENTIALS%
%%%%%%%

\RequirePackage{asymptote}
\begin{asydef}
size(6cm);
import olympiad;
import cse5;
import geometry;
\end{asydef}

\RequirePackage{tikz}
\RequirePackage{tkz-euclide}
\usetikzlibrary{calc}

\RequirePackage{babel}

\RequirePackage{amsmath,amssymb,amsthm}
\RequirePackage{mdframed}

% useful operators

\input{mathOperators}

% hyperref

\RequirePackage[hypertexnames=false]{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=darkblue,
    urlcolor=darkblue
}

% toc looks bad with hyperref

\newcommand{\toc}{
{\hypersetup{
	citecolor=black,
	filecolor=black,
	linkcolor=black,
	urlcolor=black}
\tableofcontents}
}

%%%%%%%%
%PAGE LAYOUT%
%%%%%%%%

\RequirePackage[letterpaper,top=2cm,bottom=2cm,left=2.5cm,right=2.5cm,includeheadfoot]{geometry} % geometry has to be BEFORE fancyhdr for margins to work!

%%%%%%%%%%%%
%FONTS AND SYMBOLS%
%%%%%%%%%%%%

%\RequirePackage{newpxtext,newpxmath}

\RequirePackage{fontawesome}
\RequirePackage{marvosym}
\RequirePackage{pifont}
\RequirePackage{MnSymbol}
\RequirePackage[skaknew]{skak}

\input{fonts}

% chess font black bagic i do not care to understand

\RequirePackage{adjustbox} % needs adjustbox

\newcommand{\pawnB}[1][1.3ex]{%
\adjustbox{Trim=4.3pt 2.6pt 4.3pt 0pt,width=#1,margin=0.2ex 0ex 0.2ex 0ex}{\BlackPawnOnWhite}%
}%
\newcommand{\rookB}[1][1.58ex]{%
\adjustbox{Trim=3.2pt 2.2pt 3.2pt 0pt,width=#1,raise=0ex,margin=0.1ex 0ex 0.1ex 0ex}{\BlackRookOnWhite}%
}%
\newcommand{\knightB}[1][1.85ex]{%
\adjustbox{Trim=2.3pt 2.35pt 2.5pt 0pt,width=#1,raise=-0.03ex,margin=0.14ex 0ex 0.14ex 0ex}{\BlackKnightOnWhite}%
}%
\newcommand{\bishopB}[1][1.79ex]{%
\adjustbox{Trim=2.3pt 2pt 2.3pt 0pt,width=#1,raise=-0.12ex,margin=0.1ex 0ex 0.1ex 0ex}{\BlackBishopOnWhite}%
}%
\newcommand{\queenB}[1][2.05ex]{%
\adjustbox{Trim=1.2pt 2.2pt 1.2pt 0pt,width=#1,raise=-0.08ex,margin=0.1ex 0ex 0.1ex 0ex}{\BlackQueenOnWhite}%
}%
\newcommand{\kingB}[1][1.95ex]{%
\adjustbox{Trim=2pt 2pt 2pt 0pt,width=#1,raise=-0.06ex,margin=0.13ex 0ex 0.13ex 0ex}{\BlackKingOnWhite}%
}%

% itemize symbols
\renewcommand{\labelitemi}{$\filledmedsquare$}
\renewcommand{\labelitemii}{\ding{70}}
\renewcommand{\labelitemiii}{$\bullet$}

%%%%%%
%COLORS%
%%%%%%

\RequirePackage{xcolor}

\definecolor{remcolor}{RGB}{220,220,220}

\definecolor{dennispurple}{RGB}{45,0,90} % dark purple
\definecolor{lightpurple}{RGB}{230,230,250}

\definecolor{importantred}{RGB}{100,15,15}
\definecolor{thmred}{RGB}{240, 200, 200}

\definecolor{thmblue}{rgb}{0.88, 0.95, 0.98}
\definecolor{darkblue}{RGB}{36,57,108}

\definecolor{thmgreen}{RGB}{207,241,208}
\definecolor{darkgreen}{RGB}{30,70,30}

%%%%%%%%%%%
%TITLE AND HEADERS%
%%%%%%%%%%%

\RequirePackage{etoolbox} % used for patchcmd

\patchcmd{\@maketitle}{\@title}{\merri\color{dennispurple}\bfseries\@title}{}{}
\patchcmd{\@maketitle}{\@author}{\merri\@author}{}{}
\patchcmd{\@maketitle}{\@date}{\merri\color{dennispurple}{\@date}}{}{}

%%%%%%%%
%SECTIONING%
%%%%%%%%

\RequirePackage{titlesec}

\titleformat{\section}
{\notofont\Large\bfseries}{{\color{dennispurple}\faGlobe\,\thesection}}{0.8em}{}

% subsections
\titleformat{\subsection}
{\sffamily\large\bfseries}{{\color{dennispurple}\thesubsection}}{0.9em}{}

%subsubsections (just in case!)

\titleformat{\subsubsection}
{\sffamily\normalsize\bfseries}{{\color{dennispurple}\thesubsubsection}}{0.9em}{}

%%%%%
%EMPH%
%%%%%

% db to be dennispurple

\newcommand{\db}[1]{{\color{dennispurple}\bfseries #1}}

\usepackage{bm}

\newcommand{\ansbold}[1]{{\color{dennispurple}\bm{#1}}}

%%%%%%%
%PROBLEMS%
%%%%%%%

% convenience macros

\newcommand{\probSymb}{\pawnB}
\newcommand{\reqSymb}{\knightB}

% page setup

\newcommand{\problems}{\pagebreak\section{Problems}}

\newcommand{\minpt}[1]{Minimum is {\color{dennispurple}[#1\,\probSymb]}. Problems denoted with {\color{importantred}\reqSymb} are required. (They still count towards the point total.)}

\newcommand{\psetquote}[2] % BE CAREFUL WITH THIS. must be DIRECTLY after minpt
{
\begin{flushright}
\begin{tikzpicture}
\draw (0,0) node [right,text width=8.75cm]{
\begin{mdframed}[linecolor=dennispurple,leftline=true,rightline=false,bottomline=false,topline=false,linewidth=3pt,backgroundcolor=lightpurple]
{\alegreyafont``#1''}

\vspace{1mm}

\hfill\color{importantred}\fell#2
\end{mdframed}
};

\end{tikzpicture}
\end{flushright}
}

%\newcommand{\thickness}{1/60} % for convenience

%\newcommand{\psetquote}[3]{% arguments are size, quote, author, in that order
%{
%\begin{flushright}
%\begin{tikzpicture}
%
%\filldraw[color=lightpurple] (0,0)--(5/3*#1,0)--(2*#1,1/3*#1)--(2*#1,#1)--(1/3*#1,#1)--(0,2/3*#1)--cycle;
%
%\filldraw[color=dennispurple] (0,2/3*#1)--(1/3*#1,#1)--(0,#1)--cycle;
%\filldraw[color=dennispurple] (5/3*#1,0)--(2*#1,1/3*#1)--(2*#1,0)--cycle;
%
%\filldraw[color=dennispurple] (0,0)--(\thickness*#1,0)--(\thickness*#1,#1)--(0,#1)--cycle;
%\filldraw[color=dennispurple](2*#1,0)--(2*#1-\thickness*#1,0)--(2*#1-\thickness*#1,#1)--(2*#1,#1)--cycle;
%\filldraw[color=dennispurple] (0,#1-\thickness*#1)--(0,#1)--(2*#1,#1)--(2*#1,#1-\thickness*#1)--cycle;
%\filldraw[color=dennispurple] (0,\thickness*#1)--(0,0)--(2*#1,0)--(2*#1,\thickness*#1)--cycle;
%
%\node[text width=1.5*#1 cm] at (#1, 1/2 * #1) {%
%\begin{hyphenrules}{nohyphenation}\small\robotofont``#2'' \\\hfill {\color{importantred}#3}\end{hyphenrules}%
%};
%
%\end{tikzpicture}
%\end{flushright}
%}
%}

% actual problems

\newcommand{\prob}[3]{
{\parindent=0pt
{\robotofont\color{dennispurple}[#1\,\probSymb]\textbf{\if\relax\detokenize{#2}\else\hspace{3pt}(#2)\fi}}{\hspace{3pt}#3}
\vspace{0.2cm}
}
}

\newcommand{\req}[3]{
{\parindent=0pt
{\robotofont\color{importantred}[#1\,\reqSymb]\textbf{\if\relax\detokenize{#2}\else\hspace{3pt}(#2)\fi}}{\hspace{3pt}#3}
\vspace{0.2cm}
}
}

%%%%%%%
%THEOREMS%
%%%%%%%

% theorem styles

\newtheoremstyle{theo}%                % Name
  {0pt}%                                     % Space above
  {0pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{darkblue}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  {1.5mm}%                                    % Space after theorem head, ' ', or \newline
  {\thmnote{#3}}%                                     % Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{def}
{0pt}
{0pt}
{}
{}
{\color{darkgreen}\sffamily\bfseries}
{.}
{1.5mm}
{\thmnote{#3}}

\newtheoremstyle{ex}
{0pt}
{0pt}
{}
{}
{\color{importantred}\sffamily\bfseries}
{.}
{1.5mm}
{\thmname{#1}\thmnote{ (#3)}}

\newtheoremstyle{proof}
{0pt}
{0pt}
{}
{}
{\color{dennispurple}\notofont\bfseries}
{.}
{1.5mm}
{\thmname{#1}\thmnote{ #3}}

\newtheoremstyle{solution}
{0pt}
{0pt}
{}
{}
{\color{importantred}\notofont\bfseries}
{:}
{1.5mm}
{\thmname{#1}\thmnote{ #3}}

\newtheoremstyle{remark}
{0pt}
{0pt}
{}
{}
{\color{black}\sffamily\bfseries}
{:}
{1.5mm}
{\thmname{#1}\thmnote{ #3}}

% theorems
  
\theoremstyle{theo}

\newmdtheoremenv[
backgroundcolor=thmblue,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=0.5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{theo}{Theorem}

\theoremstyle{def}

\newmdtheoremenv[
backgroundcolor=thmgreen,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkgreen,
linewidth=0.5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{defi}{Definition}

\theoremstyle{ex}

\newmdtheoremenv[
backgroundcolor=thmred,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=importantred,
linewidth=0.5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{exam}{Example}

\newmdtheoremenv[
backgroundcolor=thmred,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=importantred,
linewidth=0.5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{exer}{Exercise}

\theoremstyle{proof}

\newmdtheoremenv[
backgroundcolor=lightpurple,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=dennispurple,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{pro}{Proof}

\theoremstyle{solution}

\newtheorem{sol}{Solution}

\input{tikzMacros}

\theoremstyle{remark}

\newmdtheoremenv[
backgroundcolor=remcolor,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark}{Remark}

\newenvironment{fact}{\begin{theo}}{\end{theo}}